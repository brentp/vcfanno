<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://github.com/brentp/vcfanno/examples/clinvar_exac/">
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>ClinvarExac - vcfanno</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">vcfanno</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li >
                    <a href="../../CHANGES/">Changes</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li class="active">
                            <a href="./">ClinvarExac</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../../CHANGES/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li class="disabled">
                    <a rel="prev" >
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/brentp/vcfanno">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#annotate-clinvar-with-exac">Annotate Clinvar With ExAC</a></li>
        
            <li><a href="#exac-config">ExAC Config</a></li>
        
            <li><a href="#postannotation">PostAnnotation</a></li>
        
            <li><a href="#flag-common-pathogenic">Flag Common Pathogenic</a></li>
        
            <li><a href="#supporting-files">Supporting Files</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="annotate-clinvar-with-exac">Annotate Clinvar With ExAC</h1>
<p>The <a href="http://biorxiv.org/content/early/2015/10/30/030338">ExAC paper</a> notes that
some of the variants in <a href="http://www.ncbi.nlm.nih.gov/clinvar/intro/">ClinVar</a> that 
are classified as pathogenic (or likely pathogenic) are actually in high enough (&gt;1%)
allele frequency in ExAC to indicate that it is unlikely that these are really pathogenic.</p>
<p>Here, we will use <code>vcfanno</code> to annotate the clinvar VCF with the allele frequencies
for ExAC so that we can find variants that are indicated as pathogenic <strong>and</strong> rare in ExAC.</p>
<p>The ExAC reports the alternate counts and the total number of chromosomes (<code>AN*</code>) and the
alternate allele counts (<code>AC*</code>) so, to we will annotate with those and then use <code>postannotation</code>
in <code>vcfanno</code> to get the <code>AF</code> as <code>AC/AN</code>. We will use
an already <a href="http://www.ncbi.nlm.nih.gov/pubmed/25701572">decomposed and normalized</a> version of
ExAC (but vcfanno will match on any of the alternate alleles if multiple are present for a given
variant). The <code>[[annotation]]</code> section in the config file will look like this:</p>
<h2 id="exac-config">ExAC Config</h2>
<pre><code>[[annotation]]
file=&quot;ExAC.r0.3.sites.vep.tidy.vcf.gz&quot;
fields = [&quot;AC_Adj&quot;, &quot;AN_Adj&quot;, &quot;AC_AFR&quot;, &quot;AN_AFR&quot;, &quot;AC_AMR&quot;, &quot;AN_AMR&quot;, &quot;AC_EAS&quot;, &quot;AN_EAS&quot;, &quot;AC_FIN&quot;, &quot;AN_FIN&quot;, &quot;AC_NFE&quot;, &quot;AN_NFE&quot;, &quot;AC_OTH&quot;, &quot;AN_OTH&quot;, &quot;AC_SAS&quot;, &quot;AN_SAS&quot;]
names = [&quot;ac_exac_all&quot;, &quot;an_exac_all&quot;, &quot;ac_exac_afr&quot;, &quot;an_exac_afr&quot;, &quot;ac_exac_amr&quot;, &quot;an_exac_amr&quot;, &quot;ac_exac_eas&quot;, &quot;an_exac_eas&quot;, &quot;ac_exac_fin&quot;, &quot;an_exac_fin&quot;, &quot;ac_exac_nfe&quot;, &quot;an_exac_nfe&quot;, &quot;ac_exac_oth&quot;, &quot;an_exac_oth&quot;, &quot;ac_exac_sas&quot;, &quot;an_exac_sas&quot;]
ops=[&quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;, &quot;self&quot;]
</code></pre>

<p>Note that we can have as many of these sections as we want with vcfanno, but here we are only
interested in annotating clinvar with a single file. The <code>fields</code> section indicates which fields to
pull from the <code>ExAC</code> VCF. The <code>names</code> section indicates how those fields will be named as they are
added to the clinvar VCF. Since we intend to match on REF and ALT, there will only be 1 match so the
<code>op</code> is just "self" for all fields.</p>
<p>Because we want to know the allele frequency, we will need to divide <code>AC</code> by <code>AN</code>. This is done in a <code>[[postannotation]]</code>
section that looks like this:</p>
<h2 id="postannotation">PostAnnotation</h2>
<pre><code>[[postannotation]]
fields=[&quot;ac_exac_all&quot;, &quot;an_exac_all&quot;]
name=&quot;af_exac_all&quot;
op=&quot;div2&quot;
type=&quot;Float&quot;
</code></pre>

<p>We need one of these section for each population, which is onerous, but simple enough to generate with
a small script. Note that the op <code>div2</code> is provided by <code>vcfanno</code>, but we could have written this as a
custom op in javascript as:</p>
<pre><code class="javascript">function div2(a, b) {
    if(a == 0){ return 0.0; }
    return (a / b).toFixed(9)
}
</code></pre>

<p>and then use:</p>
<pre><code>op=&quot;js:div2&quot;
</code></pre>

<p>in the <code>[[postannotation]]</code>.</p>
<p>These <code>postannotation</code> sections are executed in the order they are specified so we can specify a final section that
takes the maximum of all of the allele frequencies. This is informative as a truly pathogenic variant should have a
low allele frequency in all populations. Here is the section to take the maximum AF of all the populations which
we've already calculated:</p>
<pre><code>[[postannotation]]
fields=[&quot;af_exac_all&quot;, &quot;af_exac_afr&quot;, &quot;af_exac_amr&quot;, &quot;af_exac_eas&quot;, &quot;af_exac_nfe&quot;, &quot;af_exac_oth&quot;, &quot;af_exac_sas&quot;]
op=&quot;max&quot;
name=&quot;max_aaf_all&quot;
type=&quot;Float&quot;
</code></pre>

<h2 id="flag-common-pathogenic">Flag Common Pathogenic</h2>
<p>Finally, we can flag variants that have a <code>max_aaf_all</code> above some cutoff and are labelled as pathogenic.</p>
<pre><code>[[postannotation]]
fields=[&quot;clinvar_sig&quot;, &quot;max_aaf_all&quot;]
op=&quot;js:check_clinvar_aaf(clinvar_sig, max_aaf_all, 0.005)&quot;
name=&quot;common_pathogenic&quot;
type=&quot;Flag&quot;
</code></pre>

<p>Note that we use 0.005 as the allele frequency cutoff. For any variant that was not present in ExAC, the <code>max_aaf_all</code> field
will be absent from the INFO field and so this will not be called.</p>
<p>If we've saved this in a file called <code>exac-af.conf</code> then the vcfanno command looks like:</p>
<pre><code>vcfanno -js clinvar_exac.js -p 4 -base-path $EXAC_DIR clinvar_exac.conf $CLINVAR_VCF &gt; $CLINVAR_ANNOTATED_VCF
</code></pre>

<p>This command finishes in about 2 minutes on a good laptop with a core i7 processor.</p>
<p>An example INFO field from the clinvar file after annotation looks like this:</p>
<pre><code>RS=17855739;RSPOS=5831840;RV;dbSNPBuildID=123;SSR=0;SAO=1;VP=0x050060000a05150136110100;GENEINFO=FUT6:2528;WGT=1;VC=SNV;PM;NSM;REF;ASP;VLD;G5;GNO;KGPhase1;KGPhase3;LSD;OM;CLNALLE=1;CLNHGVS=NC_000019.9:g.5831840C&gt;T;CLNSRC=OMIM_Allelic_Variant;CLNORIGIN=1;CLNSRCID=136836.0001;CLNSIG=5;CLNDSDB=MedGen:OMIM;CLNDSDBID=C3151219:613852;CLNDBN=Fucosyltransferase_6_deficiency;CLNREVSTAT=single;CLNACC=RCV000017626.26;CAF=0.8393,0.1607;COMMON=1;ac_exac_all=10114;an_exac_all=121354;ac_exac_afr=3093;an_exac_afr=10402;ac_exac_amr=449;an_exac_amr=11572;ac_exac_eas=867;an_exac_eas=8638;ac_exac_fin=210;an_exac_fin=6612;ac_exac_nfe=2836;an_exac_nfe=66712;ac_exac_oth=62;an_exac_oth=906;ac_exac_sas=2597;an_exac_sas=16512;af_exac_all=0.0833;af_exac_afr=0.2973;af_exac_amr=0.0388;af_exac_eas=0.1004;af_exac_nfe=0.0425;af_exac_oth=0.0684;af_exac_sas=0.1573;max_aaf_all=0.2973;clinvar_sig=pathogenic;common_pathogenic
</code></pre>

<p>(NOTE that clinvar has applied the <code>COMMON=1</code> tag here indicating a high AF in 1kg.)</p>
<p>With our ExAC fields appearing at the end:</p>
<pre><code>ac_exac_all=10114;an_exac_all=121354;ac_exac_afr=3093;an_exac_afr=10402;ac_exac_amr=449;an_exac_amr=11572;ac_exac_eas=867;an_exac_eas=8638;ac_exac_fin=210;an_exac_fin=6612;ac_exac_nfe=2836;an_exac_nfe=66712;ac_exac_oth=62;an_exac_oth=906;ac_exac_sas=2597;an_exac_sas=16512;af_exac_all=0.0833;af_exac_afr=0.2973;af_exac_amr=0.0388;af_exac_eas=0.1004;af_exac_nfe=0.0425;af_exac_oth=0.0684;af_exac_sas=0.1573;max_aaf_all=0.2973;clinvar_sig=pathogenic;common_pathogenic
</code></pre>

<p>So this variant was classified as pathogenic, but has a <code>max_aaf_all</code> of 0.2973.</p>
<p>While the config file used to generate this final dataset was fairly involved, each step is very simple and it shows the power in vcfanno.
However, note that for most analyses, it will be sufficient to specify a config file that pulls the </p>
<h2 id="supporting-files">Supporting Files</h2>
<p>The full config and javascript files used to run this analysis are available <a href="https://github.com/brentp/vcfanno/tree/master/docs/examples/">here</a>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../examples/clinvar_exac.js"></script>
    </body>
</html>